\ChapterImageStar[cap:disenio]{Diseño de la solución}{./images/fondo.png}\label{cap:disenio}
\mbox{}\\
\section{Modelado del sistema en Archimate}
\noindent
ArchiMate es un lenguaje de modelado estandarizado por~\textit{The Open Group} que permite representar de manera estructurada y clara las diferentes capas de una arquitectura empresarial: negocio, aplicación y tecnología~\citep{opengroup_archimate_overview}. Su propósito es brindar una visión integrada que facilite la comunicación entre los distintos actores de un proyecto y que muestre cómo los procesos de negocio, los sistemas de información y la infraestructura tecnológica se relacionan entre sí.
En particular, ArchiMate se organiza en vistas que permiten enfocarse en aspectos específicos: la vista de negocio describe los procesos y actores implicados, la vista de aplicación se centra en los sistemas de software que apoyan esos procesos, y la vista de tecnología aborda la infraestructura que soporta todo el ecosistema~\citep{archi_user_guide}. Gracias a este enfoque por capas, los diagramas ayudan a identificar dependencias, puntos de mejora y la coherencia general de la solución arquitectónica.
En la guía de usuario de ArchiMate se especifica el uso y significado de cada uno de los elementos y relaciones que componen el lenguaje, facilitando la creación de modelos comprensibles, esta guía puede encontrarse \href{https://www.archimatetool.com/downloads/archi/Archi%20User%20Guide.pdf}{aquí}.

\subsection{Vista de negocio}
\noindent
\input{tablas-images/cp6/vista-negocio.tex}

\subsection{Vista de aplicación}
\noindent
\input{tablas-images/cp6/vista-application.tex}

\subsection{Vista de tecnología}
\noindent
\input{tablas-images/cp6/vista-tecnologia.tex}

\subsection{Vista general}
\noindent
\input{tablas-images/cp6/vista-general.tex}

\section{Diseño por capas de la solución}
\noindent
El diseño por capas constituye una aproximación metodológica que permite descomponer sistemas complejos en niveles de abstracción claramente diferenciados, facilitando así tanto la comprensión como la gestión de los distintos componentes que integran una solución tecnológica~\citep{Spray2023}. En este contexto, la arquitectura se estructura en tres niveles fundamentales: la capa de infraestructura, que provee los recursos físicos y de red necesarios para el funcionamiento del sistema; la capa de virtualización, que abstrae dichos recursos mediante hipervisores y clústeres de orquestación, posibilitando la ejecución flexible de máquinas virtuales y contenedores; y la capa de aplicación, donde se materializan los servicios y procesos que consumen directamente los usuarios finales. Esta organización jerárquica incentiva a una separación de responsabilidades y una mayor escalabilidad, sino que también favorece la resiliencia, la reutilización de componentes y la alineación con principios de arquitectura empresarial como los propuestos en TOGAF y ArchiMate.
\subsection{Capa de infraestructura}
\noindent
El diagrama de la capa de infraestructura, de la figura~\ref{fig:infraestructura}, representa la organización física y lógica de la solución tecnológica. La red de hipervisores, agrupada en racks, se conecta a un firewall Dell, encargado de la seguridad perimetral y la gestión de la \VPN. A partir de este punto, el switch root \GRID\ distribuye el tráfico de las diferentes salas de sistemas y a un firewall complementario Sonicwall, proporcionando segmentación y control. Finalmente, la interconexión con el switch core de la Universidad del Quindío, junto con el uso de \NAT\ y una dirección pública, permite el acceso a Internet, consolidando una infraestructura que combina virtualización, seguridad y conectividad institucional.
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.13]{tablas-images/cp6/disenio-N1.png}
    \caption{Capa de Infraestructura}\label{fig:infraestructura}
\end{figure}

\subsection{Capa de virtualización}
\noindent
El diagrama~\ref{fig:virtualizacion} ilustra la capa de virtualización de la solución, en la cual se abstraen los recursos físicos mediante hipervisores para conformar un cluster de Kubernetes (k8s). Sobre el hipervisor tipo 1 (XCP-ng) se despliega una red de máquinas virtuales organizadas en dos grupos: los nodos maestros, responsables de la orquestación y administración del \textit{cluster}, y los nodos \textit{workers}, dedicados a la ejecución de cargas de trabajo y contenedores.
\noindent
La infraestructura cuenta con dos servidores que proporcionan servicios críticos como \NAT, \textit{firewall}, DHCP y \textit{failover}, proporcionando redundancia y continuidad operativa. El esquema de red (192.168.100.0/24) se conecta mediante \textit{Network Address Translation} hacia la red de hipervisores (172.30.29.1), integrando los recursos virtualizados con la capa de infraestructura subyacente.
\noindent
En cuanto al stack tecnológico, cada máquina virtual se sustenta sobre Debian 12 Bookworm como sistema operativo base, utiliza k3s como motor ligero de Kubernetes para la gestión de contenedores, y hace uso de containerd como runtime de ejecución. Este diseño permite un entorno escalable, ligero y automatizable, orientado a la administración de servicios en la nube privada.
\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{tablas-images/cp6/disenio-N2-A.png}
\end{figure}
\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{tablas-images/cp6/disenio-N2-B.png}
    \caption{Capa de Virtualización}\label{fig:virtualizacion}
\end{figure}

\subsection{Capa de aplicación}
\noindent
El diagrama~\ref{fig:aplicacion} ilustra la capa de aplicación de la solución, estructurada sobre un cluster de Kubernetes. En este nivel, los estudiantes y/o investigadores formulan solicitudes de recursos en archivos \.yml, los cuales son procesados por el API Server del plano de control de Kubernetes. Dicho plano, compuesto por componentes como el \textit{Scheduler}, el \textit{Controller Manager} y la base de datos distribuida etcd, se encarga de orquestar y asignar los recursos solicitados.
Los nodos de Kubernetes ejecutan las cargas de trabajo a través de pods, que son las unidades mínimas de despliegue. Cada nodo incorpora servicios locales como Kubelet (gestión de contenedores), cAdvisor (monitoreo de métricas) y Kubeproxy (gestión del enrutamiento y balanceo de red). La interconexión entre nodos se realiza mediante plugins de red (como Flannel o Wavenet), en pro de la comunicación entre pods distribuidos.
Finalmente, los usuarios finales acceden a las aplicaciones desplegadas en los pods, obteniendo servicios y resultados de manera transparente, mientras que el \textit{cluster} gestiona escalabilidad, balanceo y automatización de recursos.
\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{tablas-images/cp6/disenio-N3.png}
    \caption{Capa de Aplicación}\label{fig:aplicacion}
\end{figure}

\section{Código fuente del sistema}
\noindent
El código fuente del sistema, desarrollado en el lenguaje Bash, está disponible en el repositorio de GitHub \href{https://github.com/AariazP/TG-VBC.git}{\texttt{TG-VBC}} en la rama \texttt{scripted-solution}. Este repositorio contiene scripts para la automatización de tareas en la infraestructura de virtualización basada en contenedores, incluyendo la configuración de nodos, despliegue de \VM\ y configuración de Kubernetes. 
La figura~\ref{fig:estructura-proyecto} detalla la estructura del proyecto
\begin{figure}[H]
    \centering
    \includegraphics[scale=0.4]{tablas-images/cp6/src/tree.png}
    \caption{Estructura del proyecto}\label{fig:estructura-proyecto}
\end{figure}